---
layout: null
---
<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="user-scalable=no, width=device-width, initial-scale=1.0, maximum-scale=1.0"/>
    <title>Sail Racing</title>
  </head>
  <style>
  body {
      font-size: 200%;
      background-color: black;
      color: #fcdb03;
      margin:0;
      padding:0;
      width: 100%;
      height: 100%;
  }
  .error {
      color: #F00;
  }
  </style>
  <body>
    <h1>Enable Javascript</h1>
  </body>
</html>
<script>
  var c = null;
  var error = null;
  var tracking = null;

  function pos(p) {
      c = p.coords;
      drawpage();
  }

  function err(ec) {
      error = ec;
      drawpage();
  }

  function updateposition() {
      navigator.geolocation.getCurrentPosition(pos, err);
  }

  function recordtoggle(startp) {
      if (tracking == null) {
	  tracking = setInterval(updateposition, 1000);
	  
      } else {
	  clearInterval(tracking);
	  tracking = null;
	  c = null;
      }
      drawpage();
  }

  function drawpage() {
      var e = document.body;
      var h = ""
      if (tracking == null) {
	  h += '<p><a onclick="recordtoggle();">Start</a></p>';
      } else {
	  h += '<p><a onclick="recordtoggle();">Finish</a></p>';
      }
      if (c != null) {
	  h += '<p>Latitude, Longitude: ' + c.latitude + ', ' + c.longitude + '</p>';
      }
      if (error != null) {
	  h += '<p class="error">' + error + '</p>';
      }
      e.innerHTML = h
  }
  
  function getpermission() {
      navigator.permissions.query({
	  name: 'geolocation'
      }).then(function(result) {
	  if (result.state != 'granted')
	      error = "This application requires geolocation permission to be set to granted.";
	  console.log('Permission: ' + result.state);
      });
  }

  if ("geolocation" in navigator && "permissions" in navigator) {
      getpermission()
      drawpage()
  } else {
      error = "This application doesn't work in this browser"
  }
</script>
